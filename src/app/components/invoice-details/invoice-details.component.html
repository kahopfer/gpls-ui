<div class="row justify-content-center">
  <div class="col-6">
    <app-error-alert [status]="studentsStatus"></app-error-alert>
    <p-dataTable [value]="students" [loading]="studentsLoading" loadingIcon="fa-spinner">
      <p-header>Students</p-header>
      <p-column field="fname" header="First Name"></p-column>
      <p-column field="lname" header="Last Name"></p-column>
    </p-dataTable>
  </div>
  <div class="col-6">
    <app-context-help [pageName]="'invoice-details'"></app-context-help>
    <app-error-alert [status]="guardiansStatus"></app-error-alert>
    <p-dataTable [value]="guardians" [loading]="guardiansLoading" loadingIcon="fa-spinner">
      <p-header>Guardians</p-header>
      <p-column field="fname" header="First Name"></p-column>
      <p-column field="lname" header="Last Name"></p-column>
    </p-dataTable>
  </div>
</div>
<div class="row justify-content-center">
  <div class="col-12">
    <br>
    <app-error-alert [status]="invoiceStatus"></app-error-alert>
    <p-dataTable [value]="invoices" [rows]="10" [paginator]="true" [pageLinks]="3" [(selection)]="selectedInvoice"
                 [loading]="invoicesLoading" loadingIcon="fa-spinner" sortMode="multiple" #dt>
      <p-header>Invoices</p-header>
      <p-column [style]="{'width':'38px'}" selectionMode="single"></p-column>
      <p-column field="totalCost" header="Total Cost">
        <ng-template let-col let-rate="rowData" pTemplate="body">
          {{rate[col.field]|currency}}
        </ng-template>
      </p-column>
      <p-column field="invoiceDate" header="Invoice Date" [sortable]="true">
        <ng-template let-col let-rate="rowData" pTemplate="body">
          {{rate[col.field]|date }}
        </ng-template>
      </p-column>
      <p-column field="paid" header="Paid" [filter]="true" filterMatchMode="equals">
        <ng-template pTemplate="filter" let-col>
          <p-dropdown [options]="paidOptions" [style]="{'width':'100%'}"
                      (onChange)="dt.filter($event.value,col.field,col.filterMatchMode)"
                      styleClass="ui-column-filter"></p-dropdown>
        </ng-template>
      </p-column>
      <p-footer>
        <app-download-invoice [selectedInvoice]="selectedInvoice"></app-download-invoice>
        <button type="button" class="btn btn-primary" (click)="markAsPaid(selectedInvoice)"
                [disabled]="selectedInvoice == null">
          <i class="fa fa-check"></i>
          Mark Selected Invoice as Paid
        </button>
        <button type="button" class="btn btn-danger" (click)="confirmDeleteInvoice(selectedInvoice._id)"
                [disabled]="selectedInvoice == null">
          <i class="fa fa-close"></i>
          Delete Selected Invoice
        </button>
      </p-footer>
    </p-dataTable>
    <p-confirmDialog></p-confirmDialog>
    <br>
  </div>
</div>
<div class="row justify-content-center">
  <app-back-button></app-back-button>
</div>
